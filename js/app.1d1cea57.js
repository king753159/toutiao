(function(e){function t(t){for(var n,o,l=t[0],r=t[1],c=t[2],d=0,p=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,l=1;l<a.length;l++){var r=a[l];0!==i[r]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},i={app:0},s=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=r;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0692":function(e,t,a){"use strict";a("bd37")},"0c1b":function(e,t,a){"use strict";a("87e0")},"1b25":function(e,t,a){},"1ff9":function(e,t,a){"use strict";a("256c")},"256c":function(e,t,a){},3757:function(e,t,a){"use strict";a("6e66")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},s=[],o={name:"App"},l=o,r=a("2877"),c=Object(r["a"])(l,i,s,!1,null,null,null),u=c.exports,d=a("8c4f"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-container"},[a("div",{staticClass:"login-head"}),a("el-form",{ref:"login-form",staticClass:"login-form",attrs:{rules:e.formRules,model:e.user}},[a("el-form-item",{attrs:{prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.user.mobile,callback:function(t){e.$set(e.user,"mobile",t)},expression:"user.mobile"}})],1),a("el-form-item",{attrs:{prop:"code"}},[a("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:e.user.code,callback:function(t){e.$set(e.user,"code",t)},expression:"user.code"}})],1),a("el-form-item",{attrs:{prop:"agree"}},[a("el-checkbox",{model:{value:e.user.agree,callback:function(t){e.$set(e.user,"agree",t)},expression:"user.agree"}},[e._v("我已阅读并同意用户协议和隐私条款")])],1),a("el-form-item",[a("el-button",{staticClass:"login-btn",attrs:{loading:e.loginLoading,type:"primary"},on:{click:e.onLogin}},[e._v("登录")])],1)],1)],1)},m=[],f=(a("d3b7"),a("bc3a")),g=a.n(f),h=a("d604"),b=a.n(h),v=a("5c96"),_=a.n(v),y=g.a.create({baseURL:"http://api-toutiao-web.itheima.net/",transformResponse:[function(e){try{return b.a.parse(e)}catch(t){return e}}]});y.interceptors.request.use((function(e){var t=JSON.parse(window.sessionStorage.getItem("user"));return t&&(e.headers.Authorization="Bearer ".concat(t.token)),e})),y.interceptors.response.use((function(e){return e}),(function(e){var t=e.response.status;return 401===t?(window.sessionStorage.removeItem("user"),mt.push("/login"),Object(v["Message"])("登录状态无效，请重新登录")):403===t?Object(v["Message"])("没有操作权限"):400===t?Object(v["Message"])("参数错误，请检查请求参数"):t>=500&&v["Message"].error("服务端内部异常，请稍后重试"),Promise.reject(e)}));var w=y,x=function(e){return w({method:"POST",url:"/mp/v1_0/authorizations",data:e})},C=function(){return w({method:"GET",url:"/mp/v1_0/user/profile"})},$=function(e){return w({method:"PATCH",url:"/mp/v1_0/user/photo",data:e})},S=function(e){return w({method:"PATCH",url:"/mp/v1_0/user/profile",data:e})},I={name:"LoginIndex",data:function(){return{user:{mobile:"13911111111",code:"246810",agree:!1},loginLoading:!1,formRules:{mobile:[{required:!0,message:"手机号不能为空",trigger:"change"},{pattern:/^1[3|5|7|8|9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"change"}],code:[{required:!0,message:"验证码不能为空",trigger:"change"},{pattern:/^\d{6}$/,message:"请输入正确的验证码",trigger:"change"}],agree:[{validator:function(e,t,a){t?a():a(new Error("请勾选同意用户协议"))},trigger:"change"}]}}},methods:{onLogin:function(){var e=this;this.$refs["login-form"].validate((function(t){t&&e.login()}))},login:function(){var e=this,t=this.user;this.loginLoading=!0,x(t).then((function(t){console.log(t),e.loginLoading=!1,e.$message({message:"登录成功！",type:"success"}),window.sessionStorage.setItem("user",JSON.stringify(t.data.data)),e.$router.push("/layout")})).catch((function(t){console.log(t),e.loginLoading=!1,e.$message.error("登录失败！手机号或验证码错误")}))}}},k=I,O=(a("6eca"),Object(r["a"])(k,p,m,!1,null,null,null)),z=O.exports,A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home-container"},[e._v("首页")])},U=[],j={name:"HomeIndex",data:function(){return{}}},L=j,P=Object(r["a"])(L,A,U,!1,null,null,null),E=P.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"layout-container"},[a("el-container",{staticClass:"layout-container"},[a("el-aside",{staticClass:"aside",attrs:{width:"auto"}},[a("AppAside",{staticClass:"aside-menu",attrs:{"is-collapse":e.isCollapse}})],1),a("el-container",[a("el-header",{staticClass:"header"},[a("div",[a("i",{class:e.isCollapse?"el-icon-s-unfold":"el-icon-s-fold",on:{click:function(t){e.isCollapse=!e.isCollapse}}}),a("span",[e._v("成都王氏集团有限公司")])]),a("el-dropdown",[a("div",{staticClass:"person-box"},[a("img",{staticClass:"picture",attrs:{src:e.user.photo}}),a("span",[e._v(e._s(e.user.name)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})])]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("i",{staticClass:"el-icon-setting"}),e._v("个人设置")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.onLogout.apply(null,arguments)}}},[a("i",{staticClass:"el-icon-warning-outline"}),e._v(" 退出登录")])],1)],1)],1),a("el-main",{staticClass:"main"},[a("router-view")],1)],1)],1)],1)},T=[],q=(a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-menu",{attrs:{"default-active":e.$route.path,"background-color":"#002033","text-color":"#fff","active-text-color":"#ffd04b",router:"",collapse:e.isCollapse,"collapse-transition":!1}},[a("el-menu-item",{attrs:{index:"/layout"}},[a("i",{staticClass:"el-icon-s-home"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])]),a("el-menu-item",{attrs:{index:"/article"}},[a("i",{staticClass:"el-icon-document"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("内容管理")])]),a("el-menu-item",{attrs:{index:"/image"}},[a("i",{staticClass:"el-icon-picture"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("素材管理")])]),a("el-menu-item",{attrs:{index:"/publish"}},[a("i",{staticClass:"el-icon-s-promotion"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("发布文章")])]),a("el-menu-item",{attrs:{index:"/comment"}},[a("i",{staticClass:"el-icon-chat-dot-round"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("评论管理")])]),a("el-menu-item",{attrs:{index:"/fans"}},[a("i",{staticClass:"el-icon-present"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("粉丝管理")])]),a("el-menu-item",{attrs:{index:"/settings"}},[a("i",{staticClass:"el-icon-setting"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("个人设置")])])],1)}),V=[],R={name:"AppAside",props:["is-collapse"],data:function(){return{}},methods:{}},M=R,B=Object(r["a"])(M,q,V,!1,null,null,null),F=B.exports,N=new n["default"],H={name:"LayoutIndex",data:function(){return{user:{},isCollapse:!1}},created:function(){var e=this;this.loadUserInfo(),N.$on("update-user",(function(t){e.user.name=t.name,e.user.photo=t.photo}))},methods:{loadUserInfo:function(){var e=this;C().then((function(t){e.user=t.data.data,console.log(e.user)}))},onLogout:function(){var e=this;this.$confirm("是否退出登录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){window.sessionStorage.removeItem("user"),e.$router.push("/login"),e.$message({type:"success",message:"退出成功!"})})).catch((function(e){console.log(e)}))}},components:{AppAside:F}},J=H,G=(a("df1a"),Object(r["a"])(J,D,T,!1,null,"1f57a020",null)),K=G.exports,Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"article-container"},[a("el-card",{staticClass:"filter-card",attrs:{shadow:"always"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:"/layout"}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("内容管理")])],1)],1),a("el-form",{ref:"form",attrs:{size:"mini","label-width":"75px"}},[a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[a("el-radio",{attrs:{label:null}},[e._v("全部")]),a("el-radio",{attrs:{label:0}},[e._v("草稿")]),a("el-radio",{attrs:{label:1}},[e._v("待审核")]),a("el-radio",{attrs:{label:2}},[e._v("审核通过")]),a("el-radio",{attrs:{label:3}},[e._v("审核失败")]),a("el-radio",{attrs:{label:4}},[e._v("已删除")])],1)],1),a("el-form-item",{attrs:{label:"频道"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.channelId,callback:function(t){e.channelId=t},expression:"channelId"}},[a("el-option",{attrs:{label:"全部",value:null}}),e._l(e.channels,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],2)],1),a("el-form-item",{attrs:{label:"日期"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.rangeDate,callback:function(t){e.rangeDate=t},expression:"rangeDate"}})],1),a("el-form-item",[a("el-button",{attrs:{disabled:e.loading,type:"primary"},on:{click:function(t){return e.loadArticle(1)}}},[e._v("查询")])],1)],1)],1),a("el-card",{attrs:{shadow:"always"}},[a("div",{attrs:{slot:"header"},slot:"header"},[e._v("根据筛选条件共查询到 "+e._s(e.totalCount)+" 条结果：")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",size:"mini"}},[a("el-table-column",{attrs:{label:"封面"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.row.cover.images[0],fit:"cover",lazy:""}},[a("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[e._v(" 加载中"),a("span",{staticClass:"dot"},[e._v("...")])])])]}}])}),a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.articleStatus[t.row.status].type}},[e._v(e._s(e.articleStatus[t.row.status].text))])]}}])}),a("el-table-column",{attrs:{prop:"pubdate",label:"发布时间"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",circle:"",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return e.$router.push("/publish?id="+t.row.id)}}}),a("el-button",{attrs:{size:"mini",circle:"",type:"danger",icon:"el-icon-delete"},on:{click:function(a){return e.onDeleteArticle(t.row.id)}}})]}}])})],1),a("el-pagination",{staticClass:"page-setting",attrs:{background:"",disabled:e.loading,layout:"prev, pager, next","page-size":e.pageSize,total:e.totalCount,"current-page":e.page},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.onCurrentPage}})],1)],1)},W=[],X=(a("25f0"),function(e){return w({method:"GET",url:"/mp/v1_0/articles",params:e})}),Y=function(){return w({method:"GET",url:"/mp/v1_0/channels"})},Z=function(e){return w({method:"DELETE",url:"/mp/v1_0/articles/".concat(e)})},ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return w({method:"POST",url:"/mp/v1_0/articles",params:{draft:t},data:e})},te=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return w({method:"PUT",url:"/mp/v1_0/articles/".concat(e),params:{draft:a},data:t})},ae=function(e){return w({method:"GET",url:"/mp/v1_0/articles/".concat(e)})},ne=function(e){return w({method:"POST",url:"/mp/v1_0/user/images",data:e})},ie=function(e){return w({method:"GET",url:"/mp/v1_0/user/images",params:e})},se=function(e,t){return w({method:"PUT",url:"/mp/v1_0/user/images/".concat(e),data:{collect:t}})},oe=function(e){return w({method:"DELETE",url:"/mp/v1_0/user/images/".concat(e)})},le=function(e,t){return w({method:"PUT",url:"/mp/v1_0/comments/status",params:{article_id:e},data:{allow_comment:t}})},re={name:"ArticleIndex",data:function(){return{totalCount:0,pageSize:10,status:null,channels:[],channelId:null,rangeDate:[],tableData:[],loading:!1,page:1,articleStatus:[{status:0,text:"草稿",type:"info"},{status:1,text:"待审核",type:""},{status:2,text:"审核通过",type:"success"},{status:3,text:"审核失败",type:"warning"},{status:4,text:"已删除",type:"danger"}]}},created:function(){this.loadArticle(1),this.loadChannels()},methods:{loadArticle:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,X({page:t,per_page:this.pageSize,status:this.status,channel_id:this.channelId,begin_pubdate:this.rangeDate?this.rangeDate[0]:null,end_pubdate:this.rangeDate?this.rangeDate[1]:null}).then((function(t){e.tableData=t.data.data.results,e.totalCount=t.data.data.total_count,e.loading=!1}))},loadChannels:function(){var e=this;Y().then((function(t){e.channels=t.data.data.channels}))},onDeleteArticle:function(e){var t=this;this.$confirm("确认删除吗？","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Z(e.toString()).then((function(e){t.loadArticle(t.page)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},onCurrentPage:function(e){this.loadArticle(e)}}},ce=re,ue=(a("0c1b"),Object(r["a"])(ce,Q,W,!1,null,null,null)),de=ue.exports,pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"image-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:"/layout"}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("素材管理")])],1)],1),a("image-list")],1)],1)},me=[],fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{"padding-bottom":"20px",display:"flex","justify-content":"space-between"}},[a("el-radio-group",{attrs:{size:"mini"},on:{change:e.changeCollect},model:{value:e.collect,callback:function(t){e.collect=t},expression:"collect"}},[a("el-radio-button",{attrs:{label:!1}},[e._v("全部")]),a("el-radio-button",{attrs:{label:!0}},[e._v("收藏")])],1),e.isShowAdd?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){e.dialogUploadVisible=!0}}},[e._v("上传素材")]):e._e()],1),a("el-row",{staticStyle:{"padding-bottom":"20px"},attrs:{gutter:10}},e._l(e.pageList,(function(t,n){return a("el-col",{key:n,staticClass:"col",attrs:{xs:12,md:6,lg:4},nativeOn:{click:function(t){e.selected=n}}},[a("el-image",{staticStyle:{height:"180px",width:"180px"},attrs:{src:t.url,fit:"cover"}}),e.isShowSelected&&e.selected===n?a("div",{staticClass:"selected"}):e._e(),e.isShowAction?a("div",{staticClass:"collect-box"},[a("el-button",{attrs:{size:"mini",icon:t.is_collected?"el-icon-star-on":"el-icon-star-off",circle:"",loading:t.loading},on:{click:function(a){return e.onCollect(t)}}}),a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.deleteImg(t.id)}}})],1):e._e()],1)})),1),a("el-pagination",{attrs:{layout:"prev, pager, next",background:"",total:e.totalCount,"page-size":e.pageSize,"current-page":e.page},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.currentPage}}),a("el-dialog",{attrs:{title:"上传素材",width:"400px","append-to-body":!0,visible:e.dialogUploadVisible},on:{"update:visible":function(t){e.dialogUploadVisible=t}}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"http://api-toutiao-web.itheima.net/mp/v1_0/user/images",headers:e.uploadHeaders,name:"image","on-success":e.onUploadSuccess,"show-file-list":!1,multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])])],1)],1)},ge=[],he=(a("159b"),{name:"imageList",props:{isShowAdd:{type:Boolean,default:!0},isShowAction:{type:Boolean,default:!0},isShowSelected:{type:Boolean,default:!1}},data:function(){var e=JSON.parse(window.sessionStorage.getItem("user"));return{radio1:"全部",pageList:[],totalCount:0,pageSize:10,page:1,collect:!1,dialogUploadVisible:!1,uploadHeaders:{Authorization:"Bearer ".concat(e.token)},selected:null}},created:function(){this.loadImages(1)},methods:{loadImages:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=t,ie({collect:this.collect,page:t,per_page:this.pageSize}).then((function(t){var a=t.data.data.results;a.forEach((function(e){e.loading=!1})),e.pageList=a,e.totalCount=t.data.data.total_count}))},currentPage:function(e){this.loadImages(e)},changeCollect:function(){this.loadImages(1)},onUploadSuccess:function(){this.dialogUploadVisible=!1,this.loadImages(this.page),this.$message({type:"success",message:"上传成功！"})},onCollect:function(e){e.loading=!0,se(e.id,!e.is_collected).then((function(t){e.is_collected=!e.is_collected,e.loading=!1}))},deleteImg:function(e){var t=this;this.$confirm("确定要删除图片吗?╮(╯﹏╰）╭","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){oe(e).then((function(e){t.loadImages(t.page),t.$message({type:"success",message:"删除成功!"})}))})).catch((function(e){console.log(e)}))}}}),be=he,ve=(a("0692"),Object(r["a"])(be,fe,ge,!1,null,"ce0f9802",null)),_e=ve.exports,ye={name:"ImageIndex",components:{ImageList:_e}},we=ye,xe=Object(r["a"])(we,pe,me,!1,null,null,null),Ce=xe.exports,$e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"publish-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:"/layout"}},[e._v("首页")]),a("el-breadcrumb-item",[e._v(e._s(e.$route.query.id?"修改文章":"发布文章"))])],1)],1),a("div",[a("el-form",{ref:"form",attrs:{rules:e.formRules,model:e.articles,"label-width":"60px"}},[a("el-form-item",{attrs:{prop:"title",label:"标题"}},[a("el-input",{model:{value:e.articles.title,callback:function(t){e.$set(e.articles,"title",t)},expression:"articles.title"}})],1),a("el-form-item",{attrs:{prop:"content",label:"内容"}},[a("el-tiptap",{attrs:{height:"400",placeholder:"请输入文章内容",extensions:e.extensions,lang:"zh"},model:{value:e.articles.content,callback:function(t){e.$set(e.articles,"content",t)},expression:"articles.content"}})],1),a("el-form-item",{attrs:{label:"封面"}},[a("el-radio-group",{model:{value:e.articles.cover.type,callback:function(t){e.$set(e.articles.cover,"type",t)},expression:"articles.cover.type"}},[a("el-radio",{attrs:{label:1}},[e._v("单图")]),a("el-radio",{attrs:{label:3}},[e._v("三图")]),a("el-radio",{attrs:{label:0}},[e._v("无图")]),a("el-radio",{attrs:{label:-1}},[e._v("自动")])],1),e.articles.cover.type>0?[a("div",{staticClass:"imgDisplay"},e._l(e.articles.cover.type,(function(t,n){return a("articleCover",{key:t,model:{value:e.articles.cover.images[n],callback:function(t){e.$set(e.articles.cover.images,n,t)},expression:"articles.cover.images[index]"}})})),1)]:e._e()],2),a("el-form-item",{attrs:{prop:"channel_id",label:"频道"}},[a("el-select",{attrs:{placeholder:"请选择频道"},model:{value:e.articles.channel_id,callback:function(t){e.$set(e.articles,"channel_id",t)},expression:"articles.channel_id"}},e._l(e.channels,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onPublish(!1)}}},[e._v(e._s(e.$route.query.id?"修改":"发表"))]),e.$route.query.id?e._e():a("el-button",{on:{click:function(t){return e.onPublish(!0)}}},[e._v("存入草稿")])],1)],1)],1)])],1)},Se=[],Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-cover",on:{click:e.showCoverSelect}},[a("div",{staticClass:"cover-wrap"},[e.imgUrl?a("img",{ref:"cover-img",attrs:{src:e.value}}):a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{title:"选择封面",visible:e.dialogVisible,width:"80%","append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"素材库",name:"first"}},[a("image-list",{ref:"image-list",attrs:{isShowSelected:"",isShowAdd:!1,isShowAction:!1}})],1),a("el-tab-pane",{attrs:{label:"上传图片",name:"second"}},[a("input",{ref:"file",attrs:{type:"file",id:"file"},on:{change:e.onFileChange}}),a("img",{ref:"preImg",attrs:{width:"100"}})])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.onCoverConfirm}},[e._v("确 定")])],1)],1)],1)},ke=[],Oe=(a("3ca3"),a("ddb0"),a("2b3d"),{name:"articleCover",props:["value"],data:function(){return{dialogVisible:!1,activeName:"first",imgUrl:""}},methods:{showCoverSelect:function(){this.dialogVisible=!0},onFileChange:function(){var e=this.$refs.file.files[0],t=window.URL.createObjectURL(e);this.$refs.preImg.src=t},onCoverConfirm:function(){var e=this;if("second"===this.activeName){var t=this.$refs.file.files[0];if(!t)return this.$message({type:"warning",message:"请选择文件"}),!1;var a=new FormData;a.append("image",t),ne(a).then((function(t){e.dialogVisible=!1,e.$message({type:"success",message:"上传成功"}),e.imgUrl=t.data.data.url,e.$emit("input",t.data.data.url)}))}else if("first"===this.activeName){var n=this.$refs["image-list"],i=n.selected;if(null===i)return this.$message("请选择封面图片"),!1;this.dialogVisible=!1,this.imgUrl=n.pageList[i].url,this.$emit("input",n.pageList[i].url)}}},components:{imageList:_e}}),ze=Oe,Ae=(a("3757"),Object(r["a"])(ze,Ie,ke,!1,null,"6565a4b2",null)),Ue=Ae.exports,je=a("4ccc"),Le=(a("7eef"),{name:"PublishIndex",data:function(){return{articles:{title:"",content:"",cover:{type:0,images:[]},channel_id:null},channels:[],extensions:[new je["c"],new je["n"],new je["l"],new je["e"]({level:5}),new je["a"]({bubble:!0}),new je["r"]({bubble:!0,menubar:!1}),new je["i"],new je["m"],new je["h"]({uploadRequest:function(e){var t=new FormData;return t.append("image",e),ne(t).then((function(e){return e.data.data.url}))}}),new je["g"],new je["j"],new je["b"],new je["k"],new je["f"],new je["q"],new je["p"],new je["o"]],formRules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:5,max:30,message:"长度在 5 到 30 个字符",trigger:"blur"}],content:[{validator:function(e,t,a){"<p></p>"===t?a(new Error("请输入文章内容")):a()},trigger:"blur"},{required:!0,message:"请输入文章内容",trigger:"blur"}],channel_id:[{required:!0,message:"请选择文章频道"}]}}},created:function(){this.loadChannels(),this.$route.query.id&&this.loadArticle()},methods:{loadChannels:function(){var e=this;Y().then((function(t){var a=t.data;e.channels=a.data.channels}))},onPublish:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$refs.form.validate((function(a){if(!a)return!1;var n=e.$route.query.id;n?te(n,e.articles,t).then((function(a){e.$message({message:"".concat(t?"存入草稿":"修改","成功"),type:"success"}),e.$router.push("/article")})):(ee(e.articles,t).then((function(a){e.$message({message:"".concat(t?"存入草稿":"发布","成功"),type:"success"})})),e.$router.push("/article"))}))},loadArticle:function(){var e=this;ae(this.$route.query.id).then((function(t){e.articles=t.data.data}))}},components:{"el-tiptap":je["d"],articleCover:Ue}}),Pe=Le,Ee=(a("e392"),Object(r["a"])(Pe,$e,Se,!1,null,"68bb15f4",null)),De=Ee.exports,Te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comment-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:"/layout"}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("评论管理")])],1)],1),a("el-table",{staticClass:"table-list",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","max-height":"370"}},[a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{prop:"total_comment_count",label:"总评论数"}}),a("el-table-column",{attrs:{prop:"fans_comment_count",label:"粉丝评论数"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.comment_status?"正常":"关闭")+" ")]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949",disabled:t.row.statusDisable},on:{change:function(a){return e.editComment(t.row)}},model:{value:t.row.comment_status,callback:function(a){e.$set(t.row,"comment_status",a)},expression:"scope.row.comment_status"}})]}}])})],1),a("el-pagination",{attrs:{background:"","current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1)],1)},qe=[],Ve={name:"CommentIndex",data:function(){return{tableData:[],totalCount:0,pageSize:10,page:1}},created:function(){this.loadArticle()},methods:{loadArticle:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=t,X({response_type:"comment",page:t,per_page:this.pageSize}).then((function(t){console.log(t);var a=t.data.data,n=a.results,i=a.total_count;n.forEach((function(e){e.statusDisable=!1})),e.tableData=n,e.totalCount=i}))},handleSizeChange:function(){this.loadArticle(1)},handleCurrentChange:function(e){this.loadArticle(e)},editComment:function(e){var t=this;e.statusDisable=!0,le(e.id.toString(),e.comment_status).then((function(a){e.statusDisable=!1,t.$message({type:"success",message:e.comment_status?"开启成功！":"关闭成功！"})}))}}},Re=Ve,Me=(a("63ca"),Object(r["a"])(Re,Te,qe,!1,null,null,null)),Be=Me.exports,Fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fans-container"},[a("div",{ref:"main",staticStyle:{width:"600px",height:"400px"}}),a("Map")],1)},Ne=[],He=a("313e"),Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"map",staticStyle:{width:"600px",height:"400px"}})},Ge=[],Ke=(a("d81d"),{data:function(){return{}},mounted:function(){var e=He["a"](this.$refs.map),t={xAxis:{},yAxis:{},series:[{symbolSize:20,data:[[10,8.04],[8.07,6.95],[13,7.58],[9.05,8.81],[11,8.33],[14,7.66],[13.4,6.81],[10,6.33],[14,8.96],[12.5,6.82],[9.15,7.2],[11.5,7.2],[3.03,4.23],[12.2,7.83],[2.02,4.47],[1.05,3.33],[4.05,4.96],[6.03,7.24],[12,6.26],[12,8.84],[7.08,5.82],[5.02,5.68]],type:"scatter"}]};e.setOption(t)}}),Qe=Ke,We=Object(r["a"])(Qe,Je,Ge,!1,null,null,null),Xe=We.exports,Ye={name:"FansIndex",data:function(){return{}},mounted:function(){var e=He["a"](this.$refs.main),t={title:{text:"ECharts 入门示例"},tooltip:{},legend:{data:["销量"]},xAxis:{data:["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"]},yAxis:{},series:[{name:"销量",type:"bar",data:[5,20,36,10,10,20]}]};e.setOption(t)},components:{Map:Xe}},Ze=Ye,et=Object(r["a"])(Ze,Fe,Ne,!1,null,null,null),tt=et.exports,at=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"settings-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:"/layout"}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("个人设置")])],1)],1),a("el-row",[a("el-col",{attrs:{span:15}},[a("el-form",{ref:"form",staticClass:"setting-form",attrs:{model:e.userInfo,rules:e.ruleForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"编号"}},[e._v(" "+e._s(e.userInfo.id)+" ")]),a("el-form-item",{attrs:{label:"手机号"}},[e._v(" "+e._s(e.userInfo.mobile)+" ")]),a("el-form-item",{attrs:{prop:"name",label:"媒体名称"}},[a("el-input",{model:{value:e.userInfo.name,callback:function(t){e.$set(e.userInfo,"name",t)},expression:"userInfo.name"}})],1),a("el-form-item",{attrs:{prop:"intro",label:"媒体介绍"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:6}},model:{value:e.userInfo.intro,callback:function(t){e.$set(e.userInfo,"intro",t)},expression:"userInfo.intro"}})],1),a("el-form-item",{attrs:{prop:"email",label:"邮箱"}},[a("el-input",{model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.loadingUser},on:{click:e.onUpdateUser}},[e._v("保存设置")])],1)],1)],1),a("el-col",{staticStyle:{"text-align":"center"},attrs:{offset:2,span:4}},[a("label",{attrs:{for:"file"}},[a("el-avatar",{attrs:{shape:"square",size:150,fit:"cover",src:e.userInfo.photo}}),a("p",[e._v("点击修改头像")])],1),a("input",{ref:"file",attrs:{id:"file",type:"file",hidden:""},on:{change:e.onFileChange}})])],1)],1),a("el-dialog",{attrs:{title:"修改头像",visible:e.dialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.onDialogOpen,closed:e.onDialogClosed}},[a("div",{staticClass:"preview-image-wrap"},[a("img",{ref:"pre-image",staticClass:"preview-img",attrs:{src:e.previewImage}})]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.updatePhotoLoading},on:{click:e.onUpdate}},[e._v("确 定")])],1)])],1)},nt=[],it=(a("ac1f"),a("5319"),a("6107"),a("bab4")),st=a.n(it),ot={name:"SettingsIndex",data:function(){return{userInfo:{},dialogVisible:!1,previewImage:"",cropper:null,updatePhotoLoading:!1,ruleForm:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:1,max:7,message:"请输入 1 到 7 个字",trigger:"blur"}],intro:[{required:!0,message:"请输入简介",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}]},loadingUser:!1}},created:function(){this.loadUser()},methods:{loadUser:function(){var e=this;C().then((function(t){e.userInfo=t.data.data}))},onFileChange:function(){var e=this.$refs.file,t=window.URL.createObjectURL(e.files[0]);this.previewImage=t,this.dialogVisible=!0,this.$refs.file.value=""},onDialogOpen:function(){if(this.cropper)return this.cropper.replace(this.previewImage),!1;var e=this.$refs["pre-image"];this.cropper=new st.a(e,{aspectRatio:1,viewMode:1,dragMode:"none",cropBoxResizable:!0})},onDialogClosed:function(){},onUpdate:function(){var e=this;this.updatePhotoLoading=!0,this.cropper.getCroppedCanvas().toBlob((function(t){var a=new FormData;a.append("photo",t),$(a).then((function(a){e.updatePhotoLoading=!1,e.dialogVisible=!1,e.userInfo.photo=window.URL.createObjectURL(t),e.$message({type:"success",message:"更新用户头像成功！"}),N.$emit("update-user",e.userInfo)}))}))},onUpdateUser:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return console.log("error submit!!"),!1;e.loadingUser=!0,S(e.userInfo).then((function(t){e.loadingUser=!1,e.$message({type:"success",message:"更新用户信息成功！"}),N.$emit("update-user",e.userInfo)}))}))}}},lt=ot,rt=(a("1ff9"),Object(r["a"])(lt,at,nt,!1,null,null,null)),ct=rt.exports;n["default"].use(d["a"]);var ut=[{name:"LoginIndex",path:"/login",component:z},{path:"/layout",component:K,children:[{name:"HomeIndex",path:"",component:E},{name:"ArticleIndex",path:"/article",component:de},{name:"ImageIndex",path:"/image",component:Ce},{name:"PublishIndex",path:"/publish",component:De},{name:"CommentIndex",path:"/comment",component:Be},{name:"FansIndex",path:"/fans",component:tt},{name:"SettingsIndex",path:"/settings",component:ct}]}],dt=new d["a"]({routes:ut}),pt=JSON.parse(window.sessionStorage.getItem("user"));dt.beforeEach((function(e,t,a){"/login"!==e.path?pt?a():a("/login"):a()}));var mt=dt;a("0fae"),a("a4b1");n["default"].use(_.a),n["default"].config.productionTip=!1,new n["default"]({router:mt,render:function(e){return e(u)}}).$mount("#app")},"63ca":function(e,t,a){"use strict";a("83c8")},"6e66":function(e,t,a){},"6eca":function(e,t,a){"use strict";a("1b25")},"83c8":function(e,t,a){},"87e0":function(e,t,a){},a4b1:function(e,t,a){},b11c:function(e,t,a){},bd37:function(e,t,a){},c86c:function(e,t,a){},df1a:function(e,t,a){"use strict";a("b11c")},e392:function(e,t,a){"use strict";a("c86c")}});
//# sourceMappingURL=app.1d1cea57.js.map